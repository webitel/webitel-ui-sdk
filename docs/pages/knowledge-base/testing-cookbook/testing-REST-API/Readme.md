# How to test REST API

> [!WARNING]
> **Deprecation warning!**
>
> üìú **–ê—Ä—Ö—ñ–≤–Ω–∞ —Å—Ç–∞—Ç—Ç—è**.
> –°–∞–º –ø—ñ–¥—Ö—ñ–¥ –¥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è ‚Äì —Ü—ñ–ª–∫–æ–º –≤–∞–ª—ñ–¥–Ω–∏–π. –ê–ª–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ –ø–∞–∫–µ—Ç–∏ –∑–∞—Å—Ç–∞—Ä—ñ–ª—ñ.
> –ö—Ä–∞—â–µ –±–µ—Ä—ñ—Ç—å [`@webitel/api-services`](../../../packages/api-services/index.md), —ñ —Ç–∞–º –≤–∂–µ
> –±—ñ–ª—å—à —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ —Ç–µ—Å—Ç–∏ –ø–∏—Å–∞—Ç–∏.

Prerequisites:

[Mocking modules](../mocking-modules/Readme)

[Test utils / axiosMock](../../../packages/ui-sdk/tests/axios-mock/Readme)

## –©–æ –º–∏ —Ç–µ—Å—Ç—É—î–º–æ?

–Ø–∫ –ø—Ä–∞–≤–∏–ª–æ, —Ç–µ—Å—Ç—É—é—á–∏ API —Ñ–∞–π–ª–∏–∫–∏, –º–∏ —Ö–æ—á–µ–º–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ 2 —Ä–µ—á—ñ:

- —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è
  –∑–∞–ø–∏—Ç –≤—ñ–¥–Ω–æ—Å–Ω–æ –≤—Ö—ñ–¥–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ API –º–µ—Ç–æ–¥–∞
- —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è response –∑–∞–ø–∏—Ç—É,
  —ñ, —â–æ –≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –Ω–∞ –≤–∏—Ö–æ–¥—ñ –∑ API –º–µ—Ç–æ–¥–∞ –≤—ñ–¥–Ω–æ—Å–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –∑–∞–ø–∏—Ç.

## –¢–æ —è–∫ –∂–µ —Ü–µ —Ä–æ–±–∏—Ç—å—Å—è?

–í –æ–±–æ—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –Ω–∞–º —Ç—Ä–µ–±–∞ –º–æ–∫–Ω—É—Ç–∏ axios, —è–∫–∏–π –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ —Ä–æ–±–∏—Ç—å –∑–∞–ø–∏—Ç–∏.

### –Ø–∫ –Ω–∞–ø–∏—Å–∞—Ç–∏ —Ç–µ—Å—Ç –Ω–∞ –æ–±—Ä–æ–±–∫—É –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Ç–æ–º

–¢—É—Ç –Ω–∞–º –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –º–æ–∫–Ω—É—Ç–∏ —Å–∞–º–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –º–µ—Ç–æ–¥—É,
—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –∑ —è–∫–∏–º–∏ –≤—ñ–Ω –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥:

```javascript
it('My API method calls axios with right params', async () => {
  const request = vi.fn(() => Promise.resolve({ data: {} }));
  vi.doMock('axios', axiosMock({ default: { request } }));

  const id = '123';

  const API = (await import('../API.js')).default;

  await API.patch({ id });

  expect(JSON.parse(request.mock.lastCall[0].data)).toEqual({
    id,
  });
});
```

### –Ø–∫ –Ω–∞–ø–∏—Å–∞—Ç–∏ —Ç–µ—Å—Ç –Ω–∞ –æ–±—Ä–æ–±–∫—É –ø—ñ—Å–ª—è –∑–∞–ø–∏—Ç—É

–ê —Ç—É—Ç –Ω–∞–º —Ç—Ä–µ–±–∞ –º–æ–∫–Ω—É—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∑–∞–ø–∏—Ç—É, —ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–µ—Ç–æ–¥—É
–∑–±—ñ–≥–∞—î—Ç—å—Å—è –∑ –æ—á—ñ–∫—É–≤–∞–Ω–∏–º.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥:

```javascript
it('My API method handles API response with right transformations', async () => {
  const input = {
    my_field: 'true',
  };

  const output = {
    myField: true,
  };

  const request = vi.fn(() => Promise.resolve({ data: { items: [input] } }));
  vi.doMock('axios', axiosMock( { default: { request } }));

  const API = (await import ('../API.js')).default;

  const result = await API.getList({ ... });

  expect(result.items[0]).toEqual(output);
});
```

## Axios Instance vs Webitel-Sdk Services

–†—ñ–∑–Ω–∏—Ü—è –ø—Ä–æ—Å—Ç–∞:

–ö–æ–ª–∏ –º–∏ –≤–∏–∫–ª–∏–∫–∞—î–º–æ `instance.` `get`/`patch`/`delete` —ñ —Ç–∞–∫ –¥–∞–ª—ñ,
axios –≤–∏–∫–ª–∏–∫–∞—î —Å–∞–º–µ —Ü–µ–π –º–µ—Ç–æ–¥.

–ê –∫–æ–ª–∏ –º–∏ –≤–∏–∫–ª–∏–∫–∞—î–º–æ —Å–µ—Ä–≤—ñ—Å Webitel Sdk, —Ç–æ –≤—ñ–Ω –≤—Å–µ —Ä–æ–±–∏—Ç—å —á–µ—Ä–µ–∑
–º–µ—Ç–æ–¥ axios `request` - –∞ –æ—Ç–∂–µ, –º–∏ –º–∞—î–º–æ –º–æ–∫–∞—Ç–∏ —Å–∞–º–µ –π–æ–≥–æ.
