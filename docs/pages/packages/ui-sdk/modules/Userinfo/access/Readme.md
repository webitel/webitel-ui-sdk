# Userinfo: Access Control

Модуль відповідає за зберігання та розрахунок прав доступу до дій / сторінок / обʼєктів.

## Як назначаються Права доступу

Права доступу **сумуються** для **користувача** і **всіх його ролей**.

### Назначаються на користувача

* [Ліцензії](#ліцензії)

### Назначаються на роль

* [Global Role Permissions](#global-role-permissions)
* [Role Visual Access](#role-visual-access)
* [ObAC i RbAC](#obac--rbac) – але також можуть бути назначені і на користувача.

## Конфігурації, які впливають на наявність прав доступу

### Ліцензії

Мають найбільший вплив на функціонал: можна надати всі права користувачу та його ролі,
але без ліцензії функціонал не працюватиме.

Налаштовуються у Admin/Directory/License або у карточці користувача

*Наприклад*, 
якщо присвоїти користувачу роль, яка має глобальне право доступу на Read, а також ObAC права доступу на `cases`, але забрати у нього ліцензію `CUSTOMER_SERVICE` – то і до звернень у нього доступу не буде.

### Global Role Permissions

Складаються з CRUD прав і інших, специфічних прав на конкретні дії.

Налаштовуються в Admin/Roles у 2й табі карточки ролі.

#### Global CRUD Permissions

Фактично, "глобальне" ObAC на всі обʼєкти на конкретну дію.

#### Global Special Permissions

Всі крім попередніх. 
Регулюють, наприклад, право на прослуховування записів розмов, 
або на перегляд екрану оператора.

### ObAC / RbAC

### Role Visual Access

## З чого складаються перевірки

### 

## Для "користувачів" модуля

### TLDR

#### Є 3 "шматки" перевірки прав

1. **Перевірка на етапі роутингу**: глобальний router guard, 
який реєструється при ініціалізації `userinfoStore`.

В основному, виконує функцію "пустити"/"не пустити" до певної сторінки.

2. **Перевірка на CRUD в середині компонентів**: `useUserAccessControl` composable,
який використовується в компонентах для перевірки **CRUD** (!) прав до конкретного обʼєкта.

3. **Специфічні перевірки на глобальні права або ліцензії**:
`userinfoStore` зі своїми геттерами для таких кейсів.

#### А також необхідні enum'и

* `WtObject` – обʼєкт / сутність системи, до якої можна перевіряти права.
* `SpecialGlobalAction` – специфічна глобальна дія, до якої можна перевіряти права (наприклад, на записи розмов).
* `WebitelLicense` – ліцензія.
* `WtApplication`.
* `UiSection`: `AdminSections`, `AuditorSections`, `SupervisorSections`, `CrmSections`.

## Для "розробників" модуля
